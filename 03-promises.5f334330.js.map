{"mappings":"AAyDA,MAAMA,EAAQC,SAASC,cAAc,aAC/BC,EAAYF,SAASC,cAAc,iBAEzCF,EAAMI,iBAAiB,SAEvB,WACE,IAAIC,EAAU,EAEd,IAAIF,EAAUG,UAAUC,SAAQ,CAACC,EAAKC,IAAOD,EAAIE,YAAc,KAC/D,MAAMC,EAAW,IAAIR,EAAUG,UAAUM,KAAI,CAACC,EAAGJ,IAyB1C,IAAIK,SAAQ,CAACC,EAASC,KACZC,KAAKC,SACP,IACXH,EAAQ,MAELC,EAAI,IAAI,MA5BfF,QAAQK,WAAWR,GAAUS,MAAKC,IAChCA,EAAMd,SAAQ,CAACe,EAAMb,KACnBc,YAAW,KACW,cAAhBD,EAAKE,SACPnB,GAAW,GAEbF,EAAUG,SAASG,GAAGC,YAAcY,EAAKG,OAASH,EAAKI,OAEnDjB,IAAMN,EAAUG,SAASqB,OAAS,GACpCJ,YAAW,KACLlB,IAAYF,EAAUG,SAASqB,QAAWtB,EAGnCuB,MAAH,yBAFNA,MAAM,gBAEgC,GAEvC,IAAI,GAEJ,IAAJnB,EAAS,GACZ,G","sources":["src/js/03-promises.js"],"sourcesContent":["function createPromise(position, delay) {\n  const shouldResolve = Math.random() > 0.3;\n  if (shouldResolve) {\n    // Fulfill\n  } else {\n    // Reject\n  }\n}\n\n// ------------------------------------\n\n// const start = document.querySelector('.js-start');\n// const container = document.querySelector('.js-container');\n\n// start.addEventListener('click', onStart);\n\n// function onStart() {\n//   const result = [];\n//   [...container.children].forEach((box, i) => (box.textContent = ''));\n//   [...container.children].forEach((box, i) => {\n//     return createPromise(i)\n//       .then(smile => {\n//         box.textContent = smile;\n//         result.push('1');\n//       })\n//       .catch(smile => {\n//         box.textContent = smile;\n//       })\n//       .finally(() => {\n//         setTimeout(() => {\n//           if (i === container.children.length - 1) {\n//             if (!result.length || result.length === 3) {\n//               alert('Winner 🍒🍒🍒');\n//             } else {\n//               alert('❌Lost money!!!!😪😪😩');\n//             }\n//           }\n//         }, 500);\n//       });\n//   });\n// }\n\n// function createPromise(delay) {\n//   return new Promise((resolve, reject) => {\n//     setTimeout(() => {\n//       const random = Math.random();\n//       if (random > 0.55) {\n//         resolve('💵');\n//       } else {\n//         reject('❌');\n//       }\n//     }, 1000 * delay + 500);\n//   });\n// }\n\n// ----------------------------------------------------------------\n\nconst start = document.querySelector('.js-start');\nconst container = document.querySelector('.js-container');\n\nstart.addEventListener('click', onStart);\n\nfunction onStart() {\n  let counter = 0;\n\n  [...container.children].forEach((box, i) => (box.textContent = ''));\n  const promises = [...container.children].map((_, i) => createPromise(i));\n\n  Promise.allSettled(promises).then(items => {\n    items.forEach((item, i) => {\n      setTimeout(() => {\n        if (item.status === 'fulfilled') {\n          counter += 1;\n        }\n        container.children[i].textContent = item.value || item.reason;\n\n        if (i === container.children.length - 1) {\n          setTimeout(() => {\n            if (counter === container.children.length || !counter) {\n              alert('Winner 🍒🍒🍒');\n            } else {\n              alert('❌Lost money!!!!😪😪😩');\n            }\n          }, 500);\n        }\n      }, i * 1000);\n    });\n  });\n}\n\nfunction createPromise() {\n  return new Promise((resolve, reject) => {\n    const random = Math.random();\n    if (random > 0.55) {\n      resolve('💵');\n    } else {\n      reject('❌');\n    }\n  });\n}\n"],"names":["$47d4ff9957288465$var$start","document","querySelector","$47d4ff9957288465$var$container","addEventListener","counter","children","forEach","box","i","textContent","promises","map","_","Promise","resolve","reject","Math","random","allSettled","then","items","item","setTimeout","status","value","reason","length","alert"],"version":3,"file":"03-promises.5f334330.js.map"}